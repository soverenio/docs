# AWS Connections

You can configure Soveren to access your AWS account for automatic discovery of your data storage, including managed Kafka clusters and databases.

## New AWS Connection

You will need to create a new AWS connection [in the Soveren app](https://app.soveren.io/infrastructure-access/aws):

![AWS connections](../../img/administration/aws-connections.png "AWS connections")

There are several important parameters in the **New AWS Connection** dialog that you will need to configure for the AWS IAM role:

![New AWS connection](../../img/administration/new-aws-connection.png "New AWS connection")

* `AWS External ID`: A randomly generated identifier that should be associated with the role you configure in AWS IAM to provide Soveren with appropriate access rights.

* `Soveren AWS Account ID`: The account ID of Soveren. You will need to configure the role in AWS IAM to grant this ID the appropriate access rights.

* `Role ARN`: The role that you will need to configure in AWS IAM (see below).

!!! info "`AWS External ID` and `Soveren AWS Account ID` should be handled carefully, but they are not considered secret, sensitive, or confidential information."

## Role in AWS IAM

You will need to create a new role in AWS IAM. To do this, follow these steps:

1. Open AWS IAM.

2. Create a new role:

   2.1. **Trusted entity type**: AWS account.

   2.2. **Another AWS account**: Enter the `Soveren AWS Account ID`, i.e., `579178354807`.

   2.3. In the Options, check **Require external ID** and input the `AWS External ID` that you've generated in the **New AWS Connection** dialog.

   2.4. Select a suitable policy with the minimum required permissions for Soveren to discover your data sources. If no appropriate policy exists, you can skip this step and create the permissions later (see below).

   2.5. Ensure that the **Trust policy** appears as shown below. It is essential that you see the `Soveren AWS Account ID` in the **Principal** block.

    ```json
    {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Effect": "Allow",
                "Principal": {
                    "AWS": [
                        "arn:aws:iam::579178354807:root"
                    ]
                },
                "Action": "sts:AssumeRole",
                "Condition": {
                    "StringEquals": {
                        "sts:ExternalId": "<your external ID generated by Soveren>"
                    }
                }
            }
        ]
    }
    ```

   !!! info "During the preview phase, the Principal may appear as `"AWS": "579178354807"`. However, it will be stored as `arn:aws:iam::579178354807:root`, which is expected."

   2.6. Save the role.

   2.7. If you did not select an existing policy in step 2.4, go to the Permissions tab, enter the following default permissions, and save the role again:

    ```json
    {
        "Version": "2012-10-17",
        "Statement": [
            {
                "Effect": "Allow",
                "Action": [
                    "ec2:DescribeRegions",
                    "rds:DescribeDBInstances",
                    "rds:DescribeDBClusters",
                    "rds:DescribeDBClusterEndpoints",
                    "kafka:ListClustersV2",
                    "ec2:DescribeSecurityGroups",
                    "kafka:GetBootstrapBrokers"
                ],
                "Resource": [
                    "*"
                ]
            }
        ]
    }
    ```

   2.8. Copy the ARN of the created role, return to the [AWS connection setup in the Soveren app](https://app.soveren.io/infrastructure-access/aws), and paste it into the **Role ARN** field.

   2.9. Click **Run test**. It should display a positive result. (If not, please send us the error message.)

   2.10. Save the connection.
